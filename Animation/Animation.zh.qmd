---
title: "åŠ¨ç”»å›¾"
author:
  - "**[ç¼–è¾‘]** [é»„å¯æ˜•](https://github.com/Kathywongkx),
  [å½­é’°æ´](https://github.com/YujiePeng913);"
  - "**[è´¡çŒ®]** [ç‹è¯—ç¿”](https://github.com/ShixiangWang), 
  [ç½—é¹](https://github.com/DrRobinLuo), 
  [æ¨æ³“](https://github.com/MartinaHYang), 
  [ææŸ¯é¦¨](https://github.com/Likexin0127), 
  [çŸ³ç›ˆ](https://github.com/), 
  [éƒ‘è™](https://github.com/ZhengTiger)."
---

## ç¯å¢ƒé…ç½®

-   ç³»ç»Ÿè¦æ±‚ï¼š è·¨å¹³å°ï¼ˆLinux/MacOS/Windowsï¼‰

-   ç¼–ç¨‹è¯­è¨€ï¼šR

-   ä¾èµ–åŒ…ï¼š`gapminder`; `ggplot2`; `gganimate`; `gifski`; `Cairo`; `babynames`; `hrbrthemes`; `dplyr`; `viridis`; `tidyr`;

```{r packages setup, message=FALSE, warning=FALSE, output=FALSE}
# å®‰è£…åŒ…
if (!requireNamespace("gapminder", quietly = TRUE)) {
  install.packages("gapminder")
}
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
if (!requireNamespace("gganimate", quietly = TRUE)) {
  install.packages("gganimate")
}
if (!requireNamespace("gifski", quietly = TRUE)) {
  install.packages("gifski")
}
if (!requireNamespace("Cairo", quietly = TRUE)) {
  install.packages("Cairo")
}
if (!requireNamespace("babynames", quietly = TRUE)) {
  install.packages("babynames")
}
if (!requireNamespace("hrbrthemes", quietly = TRUE)) {
  install.packages("hrbrthemes")
}
if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}
if (!requireNamespace("viridis", quietly = TRUE)) {
  install.packages("viridis")
}
if (!requireNamespace("tidyr", quietly = TRUE)) {
  install.packages("tidyr")
}

# åŠ è½½åŒ…
library(gapminder)
library(ggplot2)
library(gganimate)
library(gifski)
library(Cairo)
library(babynames)
library(hrbrthemes)
library(dplyr)
library(viridis)
library(tidyr)
```

```{r}
sessioninfo::session_info("attached")
```

## æ•°æ®å‡†å¤‡

ä¸»è¦åˆ©ç”¨Rè‡ªå¸¦æ•°æ®é›†å’Œæ–°å† æ„ŸæŸ“æ•°æ®è¿›è¡Œç»˜å›¾

```{r load data}
#| message: false

# data_gapminder
data_gapminder <- gapminder

# data_babynames
data_babynames <- babynames

# data_covi19
data_covi19 <- readr::read_csv("https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/data_covi19.csv")
data_covi19$date <- c(6:12)
data_covi19 <- gather(data_covi19, key = "area", value = "cases", 2:7)

# data_covi19_bar
data_covi19_bar_10 <- filter(data_covi19, date == 10)
data_covi19_bar_10$frame <- rep("a",6)

data_covi19_bar_12 <- filter(data_covi19, date == 12)
data_covi19_bar_12$frame <- rep("b",6)

data_covi19_bar <- rbind(data_covi19_bar_10,data_covi19_bar_12)
```

## å¯è§†åŒ–

### 1. æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾

#### 1.1 ä»¥`gapminder`æ•°æ®é›†ä¸ºä¾‹

```{r fig1PointAnimation}
#| label: fig1PointAnimation
#| fig-cap: "æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾"
#| out.width: "95%"
#| warning: false
#| eval: false

#æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾----
p <- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, color = continent)) +
  geom_point() +
  scale_x_log10() +
  theme_bw() +
  #ç»˜åˆ¶åŠ¨ç”»
  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +
  transition_time(year) +
  ease_aes('linear')

animate(p, renderer = gifski_renderer())
```

::: {#fig-PointAnimation}
![](../images/Animation_plot1.gif){fig-alt="PointAnimation" fig-align="center" width="95%"}

æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾
:::

ä¸Šå›¾ä¸ºéšç€æ—¶é—´å˜åŒ–å„åœ°åŒºé¦–éƒ½å¯¿å‘½ä¸GDPçš„æ•£ç‚¹åŠ¨ç”»å›¾ï¼Œå…¶ä¸­æ•£ç‚¹å¤§å°è¡¨ç¤ºäººå£ï¼Œé¢œè‰²è¡¨ç¤ºåœ°åŒºã€‚

#### 1.2 åˆ†ç»„æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾

é™¤äº†å°†åˆ†ç»„å±•ç¤ºåœ¨ä¸€å¼ å›¾ä¸Šï¼Œè¿˜å¯ä»¥åˆ†å¼€ç»˜åˆ¶

```{r fig2GroupPointAnimation}
#| label: fig2GroupPointAnimation
#| fig-cap: "åˆ†ç»„æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾"
#| out.width: "95%"
#| warning: false
#| eval: false

# åˆ†ç»„æ•£ç‚¹æ°”æ³¡å›¾
p <- ggplot(data_gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +
  geom_point(alpha = 0.7, show.legend = FALSE) +
  scale_colour_manual(values = country_colors) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  facet_wrap(~continent) +  #æŒ‰åœ°åŒºå¡«è‰²åˆ†ç»„
  # ç»˜åˆ¶åŠ¨ç”»å›¾
  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +
  transition_time(year) +
  ease_aes('linear')

animate(p, renderer = gifski_renderer())
```

::: {#fig-GroupPointAnimation}
![](../images/Animation_plot2.gif){fig-alt="GroupPointAnimation" fig-align="center" width="95%"}

åˆ†ç»„æ•£ç‚¹æ°”æ³¡åŠ¨ç”»å›¾
:::

ä¸Šå›¾å°†ä¸åŒåœ°åŒºåˆ†å¼€ç»˜åˆ¶ã€‚

### 2. åŒºé—´è¿‡æ¸¡æ¡å½¢å›¾

åŒºé—´è¿‡æ¸¡æ¡å½¢å›¾å¯ä»¥åœ¨ä¸¤ç»„æ•°æ®é—´å®ç°è¿‡æ¸¡åŠ¨ç”»ã€‚

```{r fig3frame}
#| label: fig3frame
#| fig-cap: "åŒºé—´è¿‡æ¸¡æ¡å½¢å›¾"
#| out.width: "95%"
#| warning: false
#| eval: false

# åŒºé—´è¿‡æ¸¡æ¡å½¢å›¾----
a <- data.frame(group=c("A","B","C"), values=c(3,2,4), frame=rep('a',3))
b <- data.frame(group=c("A","B","C"), values=c(5,3,7), frame=rep('b',3))
data <- rbind(a,b)  


# åŒºé—´è¿‡æ¸¡åŠ¨ç”»
p <- ggplot(data, aes(x=group, y=values, fill=group)) + 
  geom_bar(stat='identity') +
  theme_bw() +
# ç»˜åˆ¶åŠ¨ç”»
  transition_states(
    frame,  #frameä½œä¸ºåŒºé—´ä¾æ®
    transition_length = 2,
    state_length = 1
  ) +
  ease_aes('sine-in-out')

animate(p, renderer = gifski_renderer())
```

::: {#fig-frame}
![](../images/Animation_plot3.gif){fig-alt="frame" fig-align="center" width="95%"}

åŒºé—´è¿‡æ¸¡æ¡å½¢å›¾
:::

å®ç°ä¸¤ç»„æ•°æ®çš„è¿‡æ¸¡åŠ¨ç”»ã€‚

ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹

```{r fig4covi19}
#| label: fig4covi19
#| fig-cap: "ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹"
#| out.width: "95%"
#| warning: false
#| eval: false

#ä»¥æ–°å† æ•°æ®ä¸ºä¾‹
##ç­›é€‰æ•°æ®
data_covi19_bar <- subset(data_covi19_bar, cases > 50000)

p <- ggplot(data_covi19_bar, aes(x=area, y=cases, fill=area)) + 
  geom_bar(stat='identity') +
  theme_bw() +
# ç»˜åˆ¶åŠ¨ç”»
  transition_states(
    frame,
    transition_length = 2,
    state_length = 1
  ) +
  ease_aes('sine-in-out')

animate(p, renderer = gifski_renderer())
```

::: {#fig-covi19}
![](../images/Animation_plot4.gif){fig-alt="covi19" fig-align="center" width="95%"}

ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹
:::

ä¸Šå›¾å±•ç¤ºäº†2020å¹´10æœˆä¸12æœˆå„åœ°åŒºæ–°å¢æ„ŸæŸ“äººæ•°çš„è¿‡æ¸¡åŠ¨ç”»å›¾ã€‚

### 3. åŠ¨æ€æŠ˜çº¿å›¾

**ä»¥`babynames`æ•°æ®é›†ä¸ºä¾‹**

```{r fig5babynames}
#| label: fig5babynames
#| fig-cap: "åŠ¨æ€æŠ˜çº¿å›¾"
#| out.width: "95%"
#| warning: false
#| eval: false

#åŠ¨æ€æŠ˜çº¿å›¾----
don <- data_babynames %>% 
  filter(name %in% c("Ashley", "Patricia", "Helen")) %>%
  filter(sex=="F")


#ç»˜å›¾
don %>%
  ggplot( aes(x=year, y=n, group=name, color=name)) +
  geom_line() +
  geom_point() +
  scale_color_viridis(discrete = TRUE) +
  ggtitle("ä½¿ç”¨ä¸‰ç§åå­—å„å¹´æ–°ç”Ÿå„¿æ•°çš„åŠ¨æ€æŠ˜çº¿å›¾") +
  theme_ipsum() +
  ylab("Number of babies born") +
  transition_reveal(year) #ä»¥æ—¶é—´ä½œä¸ºåŠ¨ç”»ä¾æ®
```

::: {#fig-babynames}
![](../images/Animation_plot5.gif){fig-alt="babynames" fig-align="center" width="95%"}

åŠ¨æ€æŠ˜çº¿å›¾
:::

ä¸Šå›¾å±•ç¤ºäº†å„å¹´ä½¿ç”¨ä»¥ä¸Šä¸‰ç§åå­—çš„æ–°ç”Ÿå„¿çš„æ•°é‡å˜åŒ–åŠ¨ç”»å›¾ã€‚

**ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹**

```{r fig6covi19}
#| label: fig6covi19
#| fig-cap: "ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹"
#| out.width: "95%"
#| warning: false
#| eval: false

##æ–°å† æ•°æ®ä¸ºä¾‹
data_covi19 %>%
  ggplot( aes(x=date, y=cases, group=area, color=area)) +
  geom_line() +
  geom_point() +
  scale_color_viridis(discrete = TRUE) +
  ggtitle("2020å¹´ä¸‹åŠå¹´å„åœ°åŒºæ–°å† æ–°å¢æ„ŸæŸ“ä¾‹æ•°") +
  theme_ipsum() +
  ylab("cases") +
  xlab("month") +
  transition_reveal(date) #ä»¥æ—¶é—´ä½œä¸ºåŠ¨ç”»ä¾æ®
```

::: {#fig-2covi19}
![](../images/Animation_plot6.gif){fig-alt="2covi19" fig-align="center" width="95%"}

ä»¥æ–°å† æ„ŸæŸ“æ•°æ®ä¸ºä¾‹
:::

ä¸Šå›¾ä¸º2020å¹´ä¸‹åŠå¹´å„åœ°åŒºæ–°å† æ–°å¢æ„ŸæŸ“ä¾‹æ•°çš„æŠ˜çº¿åŠ¨ç”»å›¾ï¼Œæ¨ªåæ ‡è¡¨ç¤ºæœˆä»½ã€‚

## åº”ç”¨åœºæ™¯

åŠ¨ç”»å›¾å¯åº”ç”¨äºå„ç§shinyç½‘é¡µï¼Œå®ç°æ•°æ®çš„åŠ¨æ€æ›´æ–°ä¸å®å†µå±•ç¤ºã€‚

::: {#fig-AnimationApplications}
![](../images/Animation_app.png){fig-alt="AnimationApp1" fig-align="center" width="60%"}

åŠ¨ç”»å›¾åº”ç”¨åœºæ™¯
:::

ä¸Šå›¾ä¸ºç–«æƒ…æœŸé—´å®æ—¶å±•ç°æ—¥æœ¬ç–«æƒ…åŠ¨æ€çš„shinyç½‘é¡µå·¥å…·GitHub - swsoyee/2019-ncov-japan: ğŸ¦  Interactive dashboard for real-time recording of COVID-19 outbreak in Japan

::: {#fig-AnimationApplications}
![](../images/Animation_app2.gif){fig-alt="AnimationApp2" fig-align="center" width="60%"}

åŠ¨ç”»å›¾åº”ç”¨åœºæ™¯
:::

åŒ—äº¬å¤§å­¦å¯è§†åŒ–ä¸å¯è§†åˆ†æå®éªŒå®¤ç ”å‘çš„ç–«æƒ…è½¨è¿¹å›¾ã€‚

ä¸Šå›¾çš„ç–«æƒ…è½¨è¿¹çº¿ä»ç—…æ­»ç‡å’Œæ„ŸæŸ“äººæ•°ä¸¤ä¸ªç»´åº¦å‡ºå‘ï¼Œä»¥çº¢è‰²æ–¹å—ä»£è¡¨æ–°å† è‚ºç‚ï¼Œå°†å…¶ç½®äºå…¶ä»–ä¼ æŸ“ç—…çš„æ•°æ®ä¸­é—´ï¼Œä¸ºç–«æƒ…å‘å±•ç»™å‡ºä¸€ä¸ªç›´è§‚çš„ä¾§å†™ï¼Œæ˜ç¡®åœ°åæ˜ æ–°å† è‚ºç‚å’Œå…¶ä»–å¤§è§„æ¨¡çš„æµè¡Œç—…ä¹‹é—´çš„å·®å¼‚ã€‚

## å‚è€ƒæ–‡çŒ®

\[1\] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.

\[2\] Bryan J (2023). gapminder: Data from Gapminder. R package version 1.0.0, https://CRAN.R-project.org/package=gapminder.

\[3\] H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016. Pedersen T, Robinson D (2024). gganimate: A Grammar of Animated Graphics. R package version 1.0.9, https://CRAN.R-project.org/package=gganimate.

\[4\] Ooms J, Kornel LesiÅ„ski, Authors of the dependency Rust crates (2024). gifski: Highest Quality GIF Encoder. R package version 1.32.0-1, https://CRAN.R-project.org/package=gifski.

\[5\] Urbanek S, Horner J (2023). Cairo: R Graphics Device using Cairo Graphics Library for Creating High-Quality Bitmap (PNG, JPEG, TIFF), Vector (PDF, SVG, PostScript) and Display (X11 and Win32) Output. R package version 1.6-2, https://CRAN.R-project.org/package=Cairo.

\[6\] Wickham H (2021). babynames: US Baby Names 1880-2017. R package version 1.0.1, https://CRAN.R-project.org/package=babynames.

\[7\] Rudis B (2024). hrbrthemes: Additional Themes, Theme Components and Utilities for 'ggplot2'. R package version 0.8.7, https://CRAN.R-project.org/package=hrbrthemes.

\[8\] Wickham H, FranÃ§ois R, Henry L, MÃ¼ller K, Vaughan D (2023). dplyr: A Grammar of Data Manipulation. R package version 1.1.4, https://CRAN.R-project.org/package=dplyr.

\[9\] Simon Garnier, Noam Ross, Robert Rudis, AntÃ´nio P. Camargo, Marco Sciaini, and CÃ©dric Scherer (2024). viridis(Lite) - Colorblind-Friendly Color Maps for R. viridis package version 0.6.5. Wickham H, Vaughan D, Girlich M (2024). tidyr: Tidy Messy Data. R package version 1.3.1, https://CRAN.R-project.org/package=tidyr.

