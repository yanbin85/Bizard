---
title: "äºŒç»´å¯†åº¦å›¾"
author:
  - "**[ç¼–è¾‘]** [å½­é’°æ´](https://github.com/YujiePeng913);"
  - "**[è´¡çŒ®]** [ç‹è¯—ç¿”](https://github.com/ShixiangWang), 
  [ç½—é¹](https://github.com/DrRobinLuo), 
  [æ¨æ³“](https://github.com/MartinaHYang), 
  [ææŸ¯é¦¨](https://github.com/Likexin0127), 
  [çŸ³ç›ˆ](https://github.com/), 
  [éƒ‘è™](https://github.com/ZhengTiger)."
---

äºŒç»´å¯†åº¦å›¾å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªæ•°å€¼å˜é‡ç»„åˆçš„åˆ†å¸ƒï¼Œé€šè¿‡é¢œè‰²æ¸å˜ï¼ˆæˆ–ç­‰é«˜çº¿é«˜ä½ï¼‰è¡¨ç¤ºåŒºåŸŸå†…è§‚æµ‹å€¼çš„æ•°é‡ã€‚æ—¢å¯ä»¥è¯†åˆ«æ•°æ®é›†ä¸­è¶‹åŠ¿ï¼Œä¹Ÿå¯ä»¥åˆ†æä¸¤ä¸ªå˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨æŸç§å…³ç³»ç­‰ã€‚æ•£ç‚¹å›¾åœ¨å±•ç¤ºå¤§å‹æ•°æ®é›†æ—¶å¯èƒ½å˜å¾—éš¾ä»¥è§£è¯»ï¼Œå› ä¸ºç‚¹ä¼šé‡å ï¼Œæ— æ³•å•ç‹¬åŒºåˆ†ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨äºŒç»´å¯†åº¦å›¾ã€‚

## ç¤ºä¾‹

![](../images/Density2D_demo.png){fig-alt="Density2D DEMO" fig-align="center" width="60%"}

æ­¤å›¾å±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾å€¼ä¹‹é—´çš„äºŒç»´æ ¸å¯†åº¦åˆ†å¸ƒã€‚é€šè¿‡æ …æ ¼å›¾çš„å¡«å……é¢œè‰²ï¼Œå¯ä»¥ç›´è§‚åœ°çœ‹åˆ°åœ¨ä¸åŒTP53å’ŒMDM2å€¼ç»„åˆä¸‹ï¼Œæ ·æœ¬çš„å¯†åº¦ï¼ˆå³æ ·æœ¬æ•°é‡ï¼‰ã€‚é¢œè‰²è¶Šæ·±è¡¨ç¤ºè¯¥åŒºåŸŸçš„æ ·æœ¬å¯†åº¦è¶Šä½ï¼Œè€Œé¢œè‰²è¾ƒæµ…è¡¨ç¤ºæ ·æœ¬å¯†åº¦è¾ƒé«˜ã€‚è¿™ç§å¯è§†åŒ–æœ‰åŠ©äºè¯†åˆ«åŸºå› è¡¨è¾¾çš„æ¨¡å¼å’Œæ½œåœ¨çš„ç›¸å…³æ€§ã€‚

## ç¯å¢ƒé…ç½®

-   ç³»ç»Ÿè¦æ±‚ï¼š è·¨å¹³å°ï¼ˆLinux/MacOS/Windowsï¼‰

-   ç¼–ç¨‹è¯­è¨€ï¼šR

-   ä¾èµ–åŒ…ï¼š`ggplot2`, `RColorBrewer`, `hexbin`, `MASS`, `plotly`, `mvtnorm`, `patchwork`

```{r packages setup, message=FALSE, warning=FALSE, output=FALSE}
# å®‰è£…åŒ…
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
if (!requireNamespace("RColorBrewer", quietly = TRUE)) {
  install.packages("RColorBrewer")
}
if (!requireNamespace("hexbin", quietly = TRUE)) {
  install.packages("hexbin")
}
if (!requireNamespace("MASS", quietly = TRUE)) {
  install.packages("MASS")
}
if (!requireNamespace("plotly", quietly = TRUE)) {
  install.packages("plotly")
}
if (!requireNamespace("mvtnorm", quietly = TRUE)) {
  install.packages("mvtnorm")
}
if (!requireNamespace("patchwork", quietly = TRUE)) {
  install.packages("patchwork")
}

# åŠ è½½åŒ…
library(ggplot2)
library(RColorBrewer)
library(hexbin)
library(MASS)
library(plotly)
library(mvtnorm)
library(patchwork)
```

```{r}
sessioninfo::session_info("attached")
```

## æ•°æ®å‡†å¤‡

ä½¿ç”¨ R å†…ç½®æ•°æ®é›† `mtcars`å’Œ [CSC Xena DATASETS](https://xenabrowser.net/datapages/?hub=https://gdcv18.xenahubs.net:443) çš„ `TCGA-BRCA.star_counts.tsv` æ•°æ®é›†ã€‚

```{r load data}
#| message: false

# mtcars
data_mtcars <- mtcars[, c("mpg", "hp")]

# TCGA-BRCA.star_counts
tcga_raw <- readr::read_tsv("https://bizard-1301043367.cos.ap-guangzhou.myqcloud.com/TCGA-BRCA.star_counts.tsv")

tcga_tp53_mdm2 <- tcga_raw[tcga_raw$Ensembl_ID %in% c("ENSG00000141510.18", "ENSG00000131747.15"), ]
TP53_values <- tcga_tp53_mdm2[1, -1]
MDM2_values <- tcga_tp53_mdm2[2, -1]

data_tcga <- data.frame(TP53 = as.numeric(TP53_values),
                        MDM2 = as.numeric(MDM2_values))
```


## å¯è§†åŒ–

### 1. äºŒç»´ç›´æ–¹å›¾

äºŒç»´ç›´æ–¹å›¾ç”¨äºåˆ†æä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œç»˜å›¾åŒºåŸŸè¢«åˆ’åˆ†ä¸ºå¤šä¸ªæ–¹å—ã€‚ä½¿ç”¨`geom_bin_2d()`ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾ã€‚æ­¤å‡½æ•°æä¾›äº†`bins`å‚æ•°æ¥æ§åˆ¶è¦æ˜¾ç¤ºçš„ç®±æ•°ã€‚`bins`å†³å®šæ¯ä¸€ä¸ªç®±ä½“åŒ…å«æ•°æ®çš„å¤šå°‘ï¼Œæ”¹å˜`bins`ä¼šå¯¹å›¾å½¢é€ æˆå¾ˆå¤§çš„å½±å“ï¼Œä¹Ÿä¼šå½±å“åˆ°æƒ³è¦è¡¨è¾¾çš„ä¿¡æ¯ã€‚

```{r fig1BasicPlot}
#| label: fig-BasicPlot
#| fig-cap: "äºŒç»´ç›´æ–¹å›¾"
#| out.width: "95%"
#| warning: false

# äºŒç»´ç›´æ–¹å›¾
p <- ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_bin2d() +
  labs(fill = "Gene_expression\n(STAR_counts)") + 
  theme_bw()

p
```

æ­¤å›¾ä¸ºTP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„äºŒç»´ç›´æ–¹å›¾ï¼Œé€šè¿‡é¢œè‰²æ·±æµ…è¡¨ç¤ºæ¯ä¸ªåŒºåŸŸçš„æ•°æ®ç‚¹æ•°é‡ï¼Œèƒ½å¤Ÿæ¸…æ™°åœ°æ˜¾ç¤ºæ•°æ®åˆ†å¸ƒå’Œå¯†åº¦ã€‚é¢œè‰²è¶Šæ·±è¡¨ç¤ºè¯¥åŒºåŸŸçš„æ ·æœ¬å¯†åº¦è¶Šä½ï¼Œè€Œé¢œè‰²è¾ƒæµ…è¡¨ç¤ºæ ·æœ¬å¯†åº¦è¾ƒé«˜ã€‚

```{r fig2ChangeColor}
#| label: fig-ChangeColor
#| fig-cap: "æ”¹å˜é¢œè‰²"
#| out.width: "95%"
#| warning: false
#| fig-width: 12
#| fig-height: 5

# ä¿®æ”¹bins + è°ƒè‰²æ¿
p1 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_bin2d(bins = 40) +
  scale_fill_continuous(type = "viridis") +
  labs(fill = "Gene_expression\n(STAR_counts)") + 
  theme_bw()

# å»é™¤ç½‘æ ¼çº¿ + è‡ªå®šä¹‰é¢œè‰²
p2 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_bin2d(bins = 40) +
  scale_fill_gradient(low = "blue", high = "red") + 
  labs(fill = "Gene_expression\n(STAR_counts)") + 
  theme_bw() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank())
p1+p2
```

æ­¤å›¾ä¸ºTP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„äºŒç»´ç›´æ–¹å›¾ï¼Œä¿®æ”¹äº†binså‚æ•°å’Œé¢œè‰²ä½¿å¾—å›¾å½¢æ›´åŠ ç¾è§‚ï¼Œæ›´èƒ½ä¼ é€’æœ‰æ•ˆä¿¡æ¯ã€‚å·¦å›¾éšç€æ•°æ®å¢å¤§ä»ç´«è‰²æ¸å˜ä¸ºé»„è‰²ï¼Œå³å›¾ç”±è“è‰²æ¸å˜ä¸ºçº¢è‰²ã€‚

### 2. äº¤äº’äºŒç»´ç›´æ–¹å›¾

ä½¿ç”¨`mvtnorm`åŒ…å’Œ`plotly`åŒ…ç»˜åˆ¶å¯äº¤äº’äºŒç»´ç›´æ–¹å›¾ã€‚

```{r fig3Interaction}
#| label: fig-Interaction
#| fig-cap: "äº¤äº’"
#| out.width: "95%"
#| warning: false

fig <- plot_ly(data_tcga, x = ~TP53, y = ~MDM2)
fig2 <- subplot(
  fig %>% add_histogram2d()
)

fig2
```

æ­¤å›¾ä¸º TP53 å’Œ MDM2 çš„äºŒç»´ç›´æ–¹å›¾ï¼Œéšç€æ•°æ®å¢å¤§æ ¼å­ä»ç´«è‰²æ¸å˜ä¸ºé»„è‰²ã€‚äº¤äº’å¼å›¾å½¢å…è®¸ç”¨æˆ·æ‚¬åœåœ¨ä¸åŒåŒºåŸŸä»¥æŸ¥çœ‹å…·ä½“çš„å¯†åº¦å€¼å’Œæ•°é‡ï¼Œæ–¹ä¾¿è·å–æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚

ä½¿ç”¨ R è‡ªå¸¦çš„æ•°æ®é›† `mtcars`ã€‚

```{r fig4Usemtcars}
#| label: fig-Usemtcars
#| fig-cap: "ä½¿ç”¨ R è‡ªå¸¦çš„æ•°æ®é›† `mtcars`"
#| out.width: "95%"
#| warning: false

# æ”¹å˜bins + è°ƒè‰²æ¿
fig <- plot_ly(data_mtcars, x = ~mpg, y = ~hp)
fig2 <- fig %>% add_histogram2d(colorscale = "Blues", nbinsx = 5, nbinsy = 6)

fig2
```

æ­¤å›¾ä½¿ç”¨ mtcars æ•°æ®é›†çš„ mpgï¼ˆæ¯åŠ ä»‘è‹±é‡Œæ•°ï¼‰å’Œ hpï¼ˆé©¬åŠ›ï¼‰æ¥ç»˜åˆ¶äºŒç»´ç›´æ–¹å›¾ï¼Œéšç€æ•°æ®å¢å¤§è“è‰²é€æ¸å˜æµ…ã€‚äº¤äº’å¼å›¾å½¢å…è®¸ç”¨æˆ·æ‚¬åœåœ¨ä¸åŒåŒºåŸŸä»¥æŸ¥çœ‹å…·ä½“çš„å¯†åº¦å€¼å’Œæ•°é‡ï¼Œæ–¹ä¾¿è·å–æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚

### 3. å…­è¾¹å½¢ç®±å›¾

å…­è¾¹å½¢ç®±å›¾æ˜¯ä¸€ç§å¯è§†åŒ–äºŒç»´æ•°æ®åˆ†å¸ƒçš„å›¾è¡¨ç±»å‹ã€‚å®ƒå°†æ•°æ®æŒ‰ç…§åæ ‡è½´åˆ’åˆ†ä¸ºå¤šä¸ªå°å…­è¾¹å½¢åŒºåŸŸï¼Œå¹¶æ ¹æ®æ¯ä¸ªåŒºåŸŸå†…æ•°æ®ç‚¹çš„æ•°é‡è¿›è¡Œä¸åŒçš„ç€è‰²ï¼Œä»¥å±•ç¤ºæ•°æ®åˆ†å¸ƒæƒ…å†µã€‚ä½¿ç”¨`geom_hex()`å‡½æ•°ç»˜åˆ¶å…­è¾¹å½¢ç®±å›¾ã€‚

```{r fig5geom_hex}
#| label: fig-geom_hex
#| fig-cap: "å…­è¾¹å½¢ç®±å›¾"
#| out.width: "95%"
#| warning: false

# å…­è¾¹å½¢ç®±å›¾
p <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_hex() +
  labs(fill = "Gene_expression\n(STAR_counts)") + 
  theme_bw()
p
```

æ­¤å…­è¾¹å½¢å›¾å±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„å…³ç³»ã€‚é¢œè‰²è¶Šæ·±è¡¨ç¤ºè¯¥åŒºåŸŸçš„æ ·æœ¬å¯†åº¦è¶Šä½ï¼Œè€Œé¢œè‰²è¾ƒæµ…è¡¨ç¤ºæ ·æœ¬å¯†åº¦è¾ƒé«˜ã€‚

```{r fig6binsColor}
#| label: fig-binsColor
#| fig-cap: "ä¿®æ”¹binså’Œè°ƒè‰²æ¿"
#| out.width: "95%"
#| warning: false

# ä¿®æ”¹bins + è°ƒè‰²æ¿
p <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_hex(bins = 40) +
  scale_fill_continuous(type = "viridis") +
  labs(fill = "Gene_expression\n(STAR_counts)") + 
  theme_bw()
p
```

æ­¤å…­è¾¹å½¢å›¾å±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„å…³ç³»ï¼Œä¿®æ”¹äº†binså‚æ•°å’Œé¢œè‰²ä½¿å¾—å›¾å½¢æ›´åŠ ç¾è§‚ï¼Œæ›´èƒ½ä¼ é€’æœ‰æ•ˆä¿¡æ¯ã€‚

ä½¿ç”¨`hexbin`åŒ…ç»˜åˆ¶å…­è¾¹å½¢ç®±å›¾ã€‚

```{r fig7hexbin}
#| label: fig-hexbin
#| fig-cap: "ä½¿ç”¨`hexbin`åŒ…ç»˜åˆ¶å…­è¾¹å½¢ç®±å›¾"
#| out.width: "95%"
#| warning: false

# ä½¿ç”¨`hexbin`åŒ…ç»˜åˆ¶å…­è¾¹å½¢ç®±å›¾
bin <- hexbin(TP53_values, MDM2_values, xbins=40)
my_colors = colorRampPalette(rev(brewer.pal(11,'Spectral')))
par(mar = c(0, 0, 0, 10), pty = "s")
plot(bin, main="" , colramp = my_colors , legend = FALSE)
```

æ­¤å…­è¾¹å½¢å›¾ä½¿ç”¨`hexbin`åŒ…ï¼Œå±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„å…³ç³»ã€‚ä½¿ç”¨è°ƒè‰²æ¿ç»™ä¸åŒæ•°å€¼åŒºé—´èµ‹äºˆä¸åŒçš„é¢œè‰²ï¼Œä½¿å›¾å½¢æ›´åŠ ç¾è§‚ã€‚

### 4. äºŒç»´å¯†åº¦å›¾

äºŒç»´å¯†åº¦å›¾æ˜¯ä¸€ç§ç”¨äºå¯è§†åŒ–ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„åˆ†å¸ƒå’Œå…³ç³»çš„å›¾è¡¨ç±»å‹ã€‚å®ƒé€šè¿‡åœ¨äºŒç»´å¹³é¢ä¸Šç»˜åˆ¶å¯†åº¦ç­‰é«˜çº¿æˆ–å¡«å……é¢œè‰²æ¥è¡¨ç¤ºæ•°æ®ç‚¹çš„åˆ†å¸ƒæƒ…å†µã€‚ä½¿ç”¨`geom_density_2d`æˆ–`stat_density_2d`ç»˜åˆ¶äºŒç»´å¯†åº¦å›¾ã€‚

```{r fig8 2Ddensity}
#| label: fig-2Ddensity
#| fig-cap: "äºŒç»´å¯†åº¦å›¾"
#| out.width: "95%"
#| warning: false
#| fig-width: 18
#| fig-height: 5

# ä»…æ˜¾ç¤ºè½®å»“
p1 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  geom_density_2d()

# ä»…æ˜¾ç¤ºåŒºåŸŸé¢œè‰²
p2 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..level..), geom = "polygon")

# è½®å»“ï¼‹åŒºåŸŸé¢œè‰²
p3 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..level..), geom = "polygon", colour="white")

p1+p2+p3
```

æ­¤å¯¹æ¯”å›¾æä¾›äº†å¯¹TP53å’ŒMDM2åŸºå› è¡¨è¾¾å€¼çš„å¤šç§å¤šå±‚æ¬¡ç†è§£ï¼Œä¾¿äºå¿«é€Ÿè¯†åˆ«æ•°æ®çš„æ¨¡å¼å’Œè¶‹åŠ¿ã€‚äºŒç»´ç­‰å¯†åº¦çº¿å¯ä»¥å¸®åŠ©è¯†åˆ«ä¸åŒå¯†åº¦åŒºåŸŸã€‚é€šè¿‡é¢œè‰²æ·±æµ…è¡¨ç¤ºåŸºå› çš„è¡¨è¾¾é‡ï¼Œé¢œè‰²è¶Šæµ…è¡¨ç¤ºå¯†åº¦è¶Šé«˜ï¼Œä»è€Œç›´è§‚å±•ç¤ºæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚

```{r fig9 2DKernelDensity}
#| label: fig-2DKernelDensity
#| fig-cap: "äºŒç»´æ ¸å¯†åº¦å›¾"
#| out.width: "95%"
#| warning: false

# æ …æ ¼å›¾
p <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(legend.position='none')
p
```

æ­¤å›¾å±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾å€¼ä¹‹é—´çš„äºŒç»´æ ¸å¯†åº¦åˆ†å¸ƒï¼Œé€šè¿‡é¢œè‰²æ·±æµ…è¡¨ç¤ºåŸºå› çš„è¡¨è¾¾é‡ï¼Œé¢œè‰²è¶Šæµ…è¡¨ç¤ºå¯†åº¦è¶Šé«˜ã€‚

### 5. è‡ªå®šä¹‰è°ƒè‰²æ¿

äºŒç»´ç›´æ–¹å›¾ã€å…­è¾¹å½¢ç®±å›¾å’ŒäºŒç»´å¯†åº¦å›¾éƒ½å¯ä»¥è‡ªå®šä¹‰å›¾è¡¨çš„é¢œè‰²ã€‚å¯ä»¥ä½¿ç”¨`scale_fill_distiller()`å‡½æ•°å®šä¹‰é¢œè‰²ã€‚

```{r fig10 ColorPlatte}
#| label: fig-ColorPlatte
#| fig-cap: "è‡ªå®šä¹‰è°ƒè‰²æ¿"
#| out.width: "95%"
#| warning: false
#| fig-width: 15
#| fig-height: 5

# è‡ªå®šä¹‰è°ƒè‰²æ¿
p1 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  scale_fill_distiller(palette=4, direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(legend.position='none')

p2 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  scale_fill_distiller(palette=4, direction=1) + #æ›´æ”¹è°ƒè‰²æ¿çš„æ–¹å‘ä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ª
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(legend.position='none')

# é€šè¿‡è°ƒè‰²æ¿åå­—ä½¿ç”¨è°ƒè‰²æ¿
p3 <- 
  ggplot(data_tcga, aes(x = TP53, y = MDM2)) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  scale_fill_distiller(palette= "Spectral", direction=1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(legend.position='none')

p1+p2+p3
```

æ­¤å›¾å¯¹æ¯”äº†ä¸åŒè°ƒè‰²æ¿è®¾ç½®ä¸‹çš„TP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„äºŒç»´å¯†åº¦åˆ†å¸ƒï¼Œé€šè¿‡ä¸åŒè°ƒè‰²æ¿çš„æ¯”è¾ƒï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å¯†åº¦å›¾åœ¨å¯è§†åŒ–è¡¨è¾¾ä¸Šçš„å·®å¼‚ï¼Œå¸®åŠ©é€‰æ‹©æ›´é€‚åˆå±•ç¤ºæ•°æ®ç‰¹å¾çš„é¢œè‰²æ–¹æ¡ˆã€‚

### 6. ä¸‰ç»´å¯†åº¦å›¾

å¯ä»¥å°†æ•£ç‚¹å›¾æ•°æ®å˜æ¢æˆç½‘æ ¼ï¼Œè®¡ç®—ç½‘æ ¼æ¯ä¸ªä½ç½®ä¸Šçš„æ•°æ®ç‚¹æ•°é‡ï¼Œç„¶åä¸ç”¨æ¸å˜é¢œè‰²æ¥è¡¨ç¤ºè¿™ä¸ªæ•°é‡ï¼Œè€Œæ˜¯ç”¨ç¬¬ä¸‰ä¸ªç»´åº¦æ¥è¡¨ç¤ºæŸäº›åŒºåŸŸçš„å¯†åº¦æ›´é«˜ã€‚

```{r fig11 3Ddensity}
#| label: fig-3Ddensity
#| fig-cap: "ä¸‰ç»´å¯†åº¦å›¾"
#| out.width: "95%"
#| warning: false

# è®¡ç®— KDE
kd <- with(data_tcga, MASS::kde2d(TP53, MDM2, n = 50))

plot_ly(x = kd$x, y = kd$y, z = kd$z) %>%
  add_surface() %>%
  layout(scene = list(xaxis = list(title = "TP53"),
                      yaxis = list(title = "MDM2"),
                      zaxis = list(title = "Density")))
```

æ­¤å›¾å±•ç¤ºäº†TP53å’ŒMDM2åŸºå› è¡¨è¾¾çš„ä¸‰ç»´æ ¸å¯†åº¦å›¾ï¼ˆKDEï¼‰ï¼Œä½¿ç”¨plotlyåŒ…å¯ä»¥å®ç°äº¤äº’æ“ä½œï¼Œç”¨æˆ·å¯ä»¥æ—‹è½¬å’Œç¼©æ”¾å›¾å½¢ï¼Œæ·±å…¥åˆ†ææ•°æ®ï¼Œæ›´å…¨é¢åœ°ç†è§£å¤æ‚æ•°æ®é›†ä¸­çš„å˜é‡å…³ç³»ã€‚é¢œè‰²å’Œé«˜åº¦åŒæ—¶è¡¨ç¤ºæ•°æ®çš„å¤§å°ã€‚

## åº”ç”¨åœºæ™¯

::: {#fig-Density2DApplications}
![](../images/Density2D_app1.png){fig-alt="Density2DApp1" fig-align="center" width="60%"}

äºŒç»´å¯†åº¦å›¾åº”ç”¨
:::

åœ¨ 0.5 ç§’ï¼ˆå·¦ä¸Šï¼‰ã€5 ç§’ï¼ˆå³ä¸Šï¼‰å’Œ 10 ç§’ï¼ˆä¸‹ï¼‰æ¥è§¦æ—¶é—´åæ‰“ç ´ç”˜éœ²ç³–æ¶‚å±‚çš„ AFM æ‚¬è‡‚å’Œ A. castellanii ç»†èƒä¹‹é—´çš„æ¥è§¦æ—¶ï¼Œæ–œç‡ä¸æœ€åä¸€æ¬¡ç ´è£‚äº‹ä»¶ä½ç½®çš„äºŒç»´å¯†åº¦å›¾ã€‚ \[1\]

::: {#fig-Density2DApplications}
![](../images/Density2D_app2.png){fig-alt="Density2DApp2" fig-align="center" width="60%"}

äºŒç»´å¯†åº¦å›¾åº”ç”¨
:::

æ ¹æ® LFP ä¿¡å·çš„ä¸»æˆåˆ†åˆ†æå¯¹æŒ¯è¡æ¨¡å¼è¿›è¡Œç»Ÿè®¡åˆ†ç±»çš„æŠ€æœ¯ç¤ºä¾‹ã€‚(A) äºŒç»´å¤§è„‘çŠ¶æ€å›¾ã€‚ä¸‰ä¸ªä¸»è¦ç°‡åˆ†åˆ«å¯¹åº”äºæ¸…é†’çŠ¶æ€ (WK)ã€æ…¢æ³¢ç¡çœ  (SWS) å’Œå¿«é€Ÿçœ¼åŠ¨ (REM) çŠ¶æ€ã€‚(B) SI LFP é€šé“çš„åŠŸç‡è°±å›¾æ˜¾ç¤ºäº†å¤§è„‘çŠ¶æ€äº‹ä»¶è½¬æ¢è¿‡ç¨‹ä¸­ä¿¡å·åŠŸç‡æŒ¯è¡çš„ä¸åŒæ¨¡å¼ã€‚(C) ä»å›¾ A ä¸­æ‰€ç¤ºçš„äºŒç»´çŠ¶æ€è·å¾—çš„å¤§è„‘çŠ¶æ€ç¡çœ å›¾ã€‚ç¼–ç äº†å…­ç§ä¸åŒçš„å¤§è„‘çŠ¶æ€ï¼šWKã€SWSã€REMã€èƒ¡é¡»æŠ½æ (WT)ã€Mï¼ˆæœªå®šä¹‰è¿åŠ¨ï¼‰å’Œ Uï¼ˆè¿‡æ¸¡çŠ¶æ€ï¼‰ã€‚(D) ä»æ•£ç‚¹å›¾ [ä¾‹å¦‚ (A)] è®¡ç®—å‡ºçš„å¯†åº¦å›¾ï¼Œæ˜¾ç¤ºäº†ä¿å®ˆçš„ç°‡æ‹“æ‰‘å’Œå„ç§å¤§è„‘çŠ¶æ€çš„ç›¸å¯¹ä¸°åº¦ã€‚æ¯”ä¾‹ä»æ·±è“è‰²ï¼ˆä½å¯†åº¦ï¼‰åˆ°çº¢è‰²ï¼ˆé«˜å¯†åº¦ï¼‰ã€‚ (E) é€Ÿåº¦å›¾è¡¨ç¤ºäºŒç»´ StateMap ä¸­è‡ªå‘è½¨è¿¹çš„å¹³å‡å€¼ã€‚åœ¨ä¸‰ä¸ªä¸»è¦ç°‡ï¼ˆWKã€SWS å’Œ REMï¼‰ä¸­å¯ä»¥è§‚å¯Ÿåˆ°å¹³ç¨³æ€§ï¼ˆä½é€Ÿï¼‰ï¼Œè€Œåœ¨ä»ä¸€ä¸ªç°‡åˆ°å¦ä¸€ä¸ªç°‡çš„è½¬æ¢è¿‡ç¨‹ä¸­è¾¾åˆ°æœ€å¤§é€Ÿåº¦ã€‚SNI æŸä¼¤åï¼ŒWK å’Œ SWS çŠ¶æ€å‘ä½œä¹‹é—´çš„é€Ÿåº¦å¢åŠ ï¼Œè¿™ä¹Ÿè¡¨æ˜ç¥ç»æ€§ç–¼ç—›æœŸé—´ WK/SWS è½¬æ¢å¢åŠ ã€‚ \[2\]


::: {#fig-Density2DApplications}
![](../images/Density2D_app3.png){fig-alt="Density2DApp3" fig-align="center" width="60%"}

äºŒç»´å¯†åº¦å›¾åº”ç”¨
:::

ç”Ÿæ€å‹ La-0 å’Œ Fr.2 ä¸­å˜é‡ ğ¼ğ‘… å’Œ ğ¿â¢ğ¶ğ‘… ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ (A) ğ¼ğ‘… ä¸ ğ¿â¢ğ¶ğ‘… çš„äºŒç»´æ ¸å¯†åº¦å›¾è¡¨æ˜ï¼Œå¤§å¤šæ•° ğ¿â¢ğ¶ğ‘… å€¼ä½äºå‚ç›´çº¿ ğ¼ğ‘…=0 å‘¨å›´çš„çª„å¸¦ä¸­ã€‚ (B) 3D æ ¸å¯†åº¦å›¾è¡¨æ˜ï¼Œä¾‹å¦‚ï¼Œä»¥é«˜è”åˆæ¦‚ç‡ğ‘ƒ(âˆ’1â‰¤ğ¼ğ‘…â‰¤1,0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25)ï¼ˆç”±åŒºé—´ âˆ’2â‰¤ğ¼ğ‘…â‰¤2 å’Œ 0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25 å½¢æˆçš„æ–¹åº•æ£±æŸ±çš„ä½“ç§¯ï¼Œå¹¶è¢«è¦†ç›–çº¢è‰²åˆ°é»„è‰²åŒºåŸŸçš„è¡¨é¢æˆªæ–­ï¼‰è§‚å¯Ÿåˆ°å€¼ä¸º âˆ’2â‰¤ğ¼ğ‘…â‰¤2 å’Œ 0â‰¤ğ¿â¢ğ¶ğ‘…â‰¤25 çš„åŸºå› ç»„åŒºåŸŸ Rã€‚å¯¹äºè¿™äº›åŒºåŸŸï¼Œè§‚å¯Ÿåˆ° SNP çš„æ¦‚ç‡å¾ˆä½ï¼ˆæ ¹æ®æ–¹ç¨‹ (4) å’Œ (5)ï¼Œå¹¶ä¸”æ”¯æŒåŒºåŸŸæ–¹ç¨‹ (3) ä¸­ SNP çš„å½’ä¸€åŒ–è®¡æ•°å€¼å¾ˆä½ã€‚åœ¨å¦ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œä»¥ä½è”åˆæ¦‚ç‡ğ‘ƒ(âˆ’1â‰¤ğ¼ğ‘…â‰¤1,150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200)ï¼ˆå¯¹åº”äºåœ¨åŒºé—´ âˆ’1â‰¤ğ¼ğ‘…â‰¤1 å’Œ 150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200 å†…è¢«æ–¹åº•è¡¨é¢æˆªæ–­çš„æ£±æŸ±ä½“ç§¯ï¼‰ï¼Œè§‚å¯Ÿåˆ°å€¼ä¸º âˆ’1â‰¤ğ¼ğ‘…â‰¤1 å’Œ 150â‰¤ğ¿â¢ğ¶ğ‘…â‰¤200 çš„åŸºå› ç»„åŒºåŸŸ Rï¼›ï¼ˆCï¼‰ Farlieâ€“Gumbelâ€“Morgenstern copula æ˜¯æ ¹æ® ğ¿â¢ğ¶ğ‘…ï¼ˆWeibull PDFï¼‰å’Œ ğ¼ğ‘…ï¼ˆSkewâ€“Laplace PDFï¼‰ä¼°è®¡çš„è¾¹é™…åˆ†å¸ƒçš„éçº¿æ€§æ‹Ÿåˆæ„å»ºçš„ã€‚Farlieâ€“Gumbelâ€“Morgenstern copula åˆ†å¸ƒè¡¨æ˜å˜é‡ ğ¼ğ‘… å’Œ ğ¿â¢ğ¶ğ‘… ä¹‹é—´å­˜åœ¨ç»“æ„ä¾èµ–æ€§ï¼Œè¯¥åˆ†å¸ƒä»¥å¯æ¥å—çš„æ–¹å¼æè¿°äº†å›¾ B ä¸­æ˜¾ç¤ºçš„ç»éªŒè¡Œä¸ºã€‚ \[3\]

## å‚è€ƒæ–‡çŒ®

\[1\] Cardoso-Cruz H, Sameshima K, Lima D, Galhardo V. Dynamics of Circadian Thalamocortical Flow of Information during a Peripheral Neuropathic Pain Condition. Front Integr Neurosci. 2011 Aug 23;5:43. doi: 10.3389/fnint.2011.00043. PMID: 22007162; PMCID: PMC3188809.

\[2\] Rey SA, Smith CA, Fowler MW, Crawford F, Burden JJ, Staras K. Ultrastructural and functional fate of recycled vesicles in hippocampal synapses. Nat Commun. 2015 Aug 21;6:8043. doi: 10.1038/ncomms9043. PMID: 26292808; PMCID: PMC4560786.

\[3\] Sanchez R, Mackenzie SA. Genome-Wide Discriminatory Information Patterns of Cytosine DNA Methylation. Int J Mol Sci. 2016 Jun 17;17(6):938. doi: 10.3390/ijms17060938. PMID: 27322251; PMCID: PMC4926471.

\[4\] Rudis, B. (2020). hrbrthemes: Additional Themes and Theme Components for 'ggplot2'. https://cran.r-project.org/package=hrbrthemes

\[5\] Neuwirth, E. (2014). RColorBrewer: ColorBrewer Palettes. https://cran.r-project.org/package=RColorBrewer

\[6\] Ellison, A. M. (2019). hexbin: Hexagonal Binning for Visualization of Two-Dimensional Data. https://cran.r-project.org/package=hexbin

\[7\] Venables, W. N., & Ripley, B. D. (2002). MASS: Modern Applied Statistics with S. https://cran.r-project.org/package=MASS

\[8\] Sievert, C. (2023). plotly: Create Interactive Web Graphics via 'plotly.js'. https://cran.r-project.org/package=plotly

\[9\] Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer. https://ggplot2.tidyverse.org

\[10\] Genz, A., & Bretz, F. (2009). mvtnorm: Multivariate Normal and T Distributions. https://cran.r-project.org/package=mvtnorm
