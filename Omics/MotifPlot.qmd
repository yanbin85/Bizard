---
title: Motif Plot
author:
  - "**[Contributors]** [Zilun Jin](https://github.com/kintilin);"
  - "**[Editor]** GitHub Copilot."
---

Motif plots, also known as sequence logos, are used to visualize conserved patterns in biological sequences (DNA, RNA, or protein). They are commonly used in transcription factor binding site analysis, miRNA target prediction, and other sequence motif discovery applications. The height of each letter represents the information content at that position, helping researchers identify important binding sites or functional regions.

## Example

<!-- Note: Demo image needs to be added. Please add the motif plot image from the issue to ../images/Omics/MotifPlot_demo.png -->
<!-- ![](../images/Omics/MotifPlot_demo.png){fig-alt="MotifPlot DEMO" fig-align="center" width="60%"} -->

A motif plot displays sequence logos where the height of each nucleotide represents its information content at that position, helping identify conserved binding sites or functional regions in biological sequences.

## Setup

-   System Requirements: Cross-platform (Linux/MacOS/Windows)

-   Programming language: R

-   Dependent packages: `motifStack`; `Biostrings`

```{r packages setup, message=FALSE, warning=FALSE, output=FALSE}
# Install packages
if (!requireNamespace("BiocManager", quietly = TRUE)) {
  install.packages("BiocManager")
}
if (!requireNamespace("motifStack", quietly = TRUE)) {
  BiocManager::install("motifStack")
}
if (!requireNamespace("Biostrings", quietly = TRUE)) {
  BiocManager::install("Biostrings")
}

# Load packages
library(motifStack)
library(Biostrings)
```

```{r}
sessioninfo::session_info("attached")
```

## Data Preparation

Motif data can come from various sources such as transcription factor binding site databases (e.g., JASPAR, TRANSFAC), or from de novo motif discovery tools (e.g., MEME). The motifStack package can import motifs in various formats including position frequency matrix (PFM) or position weight matrix (PWM).

```{r load data, message=FALSE, warning=FALSE}
# Load example motif data from motifStack package
library(motifStack)

# Import example motifs
pcm <- read.table(system.file("extdata", "bin_SOLEXA.pcm", 
                              package = "motifStack"))
pcm <- pcm[, 3:ncol(pcm)]
rownames(pcm) <- c("A", "C", "G", "T")

# Normalize each column to sum to 1.0 (convert PCM to PFM)
pcm_matrix <- as.matrix(pcm)
pfm_matrix <- apply(pcm_matrix, 2, function(x) x / sum(x))

# Convert to pfm object
motif <- new("pfm", mat = pfm_matrix, name = "RNA_motif")

# View the normalized motif matrix
head(pfm_matrix, 4)
```

## Visualization

### 1. Basic Motif Plot

The basic motif plot displays the sequence logo where the height of each nucleotide represents its information content at that position.

```{r}
#| label: fig-1BasicMotif
#| fig-cap: "Basic motif plot"
#| out.width: "95%"
#| warning: false

# Basic motif plot
plotMotifLogo(motif)
```

### 2. Motif Plot with Custom Colors

Different color schemes can be applied to highlight different types of nucleotides or amino acids.

```{r}
#| label: fig-2ColorMotif
#| fig-cap: "Motif plot with custom colors"
#| out.width: "95%"
#| warning: false

# Motif plot with custom color scheme
# Color scheme: A=green, C=blue, G=orange, T=red
color <- c(A = "#00CC00", C = "#0000CC", G = "#FFB300", T = "#CC0000")
plotMotifLogo(motif, ic.scale = TRUE, 
              colset = color,
              font = "sans")
```

### 3. Stacked Motif Plots

Multiple motifs can be stacked together for comparison, which is useful when comparing binding sites across different transcription factors or conditions.

```{r}
#| label: fig-3StackedMotif
#| fig-cap: "Stacked motif plots for comparison"
#| out.width: "95%"
#| warning: false

# Create multiple motifs for comparison
# Import additional example motifs
pcm1 <- pfm_matrix
motif1 <- new("pfm", mat = pcm1, name = "Motif_1")

# Create a second motif (slightly modified for demonstration)
pcm2 <- pfm_matrix[, c(2:ncol(pfm_matrix), 1)]
motif2 <- new("pfm", mat = pcm2, name = "Motif_2")

# Stack motifs
motifs <- list(motif1, motif2)
motifStack(motifs, layout = "stack")
```

### 4. Radial Phylogenetic Motif Layout

For visualizing evolutionary relationships between motifs, a radial phylogenetic layout can be used.

```{r}
#| label: fig-4RadialMotif
#| fig-cap: "Radial phylogenetic motif layout"
#| out.width: "95%"
#| warning: false

# Radial layout for motif comparison
motifStack(motifs, layout = "radialPhylog")
```

## Applications

Motif plots are widely used in genomics and molecular biology research:

1.  **Transcription Factor Binding Site Analysis**: Identifying and visualizing conserved binding sequences for transcription factors in gene regulatory regions.

2.  **miRNA Target Prediction**: Displaying conserved seed sequences in miRNA binding sites.

3.  **Protein Domain Analysis**: Visualizing conserved amino acid patterns in protein families.

4.  **ChIP-seq Analysis**: Representing enriched sequence motifs discovered from chromatin immunoprecipitation sequencing data.

5.  **Comparative Genomics**: Comparing regulatory motifs across different species or conditions.

## Reference

1.  Ou, J., Wolfe, S. A., Brodsky, M. H., & Zhu, L. J. (2018). motifStack for the analysis of transcription factor binding site evolution. *Nature Methods, 15*(1), 8â€“9. <https://doi.org/10.1038/nmeth.4555>

2.  Bioconductor motifStack package: <https://bioconductor.org/packages/release/bioc/html/motifStack.html>

## Contributors

-   **Editor**: GitHub Copilot.
-   **Reviewers**: To be assigned.